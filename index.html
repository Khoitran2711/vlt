<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Sweet Valentine 3D ‚ù§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&family=Quicksand:wght@500;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --heart-color: #ff4d6d;
            --text-color: #d63384;
            --speed: 30; /* T·ªëc ƒë·ªô ƒëu·ªïi b·∫Øt ·∫£nh */
        }

        html, body {
            margin: 0; padding: 0; width: 100%; height: 100%;
            overflow: hidden; background-color: #fff5f7;
            font-family: 'Quicksand', sans-serif;
        }

        /* N·ªÅn ·∫£nh v√† l·ªõp ph·ªß */
       body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    /* Th√™m h√¨nh n·ªÅn ·ªü ƒë√¢y */
    background-image: url('background.jpg'); 
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    font-family: 'Quicksand', sans-serif; /* Font ch√≠nh: d·ªÖ ƒë·ªçc, n√©t bo tr√≤n m·ªÅm m·∫°i */
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

/* Th√™m m·ªôt l·ªõp ph·ªß m·ªù ƒë·ªÉ c√°c h·∫°t tr√°i tim v√† ch·ªØ n·ªïi b·∫≠t h∆°n */
body::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(255, 245, 247, 0.3); /* Ph·ªß m·ªôt l·ªõp h·ªìng c·ª±c nh·∫°t, trong su·ªët 30% */
    z-index: 0;
}
        .blur-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255, 255, 255, 0.3);
            backdrop-filter: blur(5px); z-index: -1;
        }

        /* M√ÄN H√åNH 1: TH·ª¨ TH√ÅCH SI√äU T·ªêC */
        #photo-challenge {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            z-index: 10; pointer-events: none;
        }

        .instruction-text {
            position: absolute; top: 40px; width: 100%; text-align: center;
            color: var(--text-color); text-shadow: 0 0 15px white;
            font-family: 'Montserrat', sans-serif; font-size: 26px; font-weight: 800;
            z-index: 11; text-transform: uppercase; pointer-events: none;
        }

        .photo-item {
            position: absolute; width: 115px; height: 115px;
            border-radius: 50%; object-fit: cover;
            border: 5px solid white; box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            cursor: pointer; pointer-events: auto;
            will-change: transform, left, top;
        }

        /* M√ÄN H√åNH 2: NH·∫¨P T√äN */
        .input-container {
            display: none; position: fixed; top: 50%; left: 50%;
            transform: translate(-50%, -50%); z-index: 25;
            background: rgba(255, 255, 255, 0.95);
            padding: 40px; border-radius: 35px; text-align: center;
            width: 320px; box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            border: 3px solid var(--heart-color);
            animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes popIn { from { opacity: 0; transform: translate(-50%, -50%) scale(0.5); } }

        input { 
            padding: 15px; width: 85%; border: 2px solid #ffccd5; border-radius: 50px; 
            outline: none; font-size: 18px; text-align: center; margin-bottom: 20px;
            font-family: 'Quicksand', sans-serif; font-weight: 700;
        }
        button { 
            padding: 15px 30px; background: var(--heart-color); color: white; 
            border: none; border-radius: 50px; cursor: pointer; font-weight: bold; 
            width: 100%; font-family: 'Quicksand', sans-serif; font-size: 16px;
        }

        /* HI·ªÜU ·ª®NG CH·ªÆ 3D */
        #love-rain {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 5;
            perspective: 1200px; /* T·∫°o chi·ªÅu s√¢u 3D */
        }

        .floating-text {
            position: absolute; white-space: nowrap; font-family: 'Montserrat', sans-serif;
            font-weight: 800; text-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
            will-change: transform, opacity;
            transform-style: preserve-3d;
            animation: float3D linear forwards;
        }

        @keyframes float3D {
            0% {
                transform: translateZ(-600px) translateY(100vh) rotateX(45deg);
                opacity: 0; filter: blur(8px);
            }
            20% { opacity: 1; filter: blur(0px); }
            80% { opacity: 1; filter: blur(0px); }
            100% {
                transform: translateZ(600px) translateY(-20vh) rotateX(-20deg);
                opacity: 0; filter: blur(3px);
            }
        }

        #final-message {
            position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0);
            width: 95%; font-size: 45px; color: var(--text-color); font-family: 'Montserrat', sans-serif;
            font-weight: 800; text-align: center; z-index: 30; transition: 1.5s;
            text-shadow: 0 0 30px white; white-space: pre-line;
        }

        canvas { position: fixed; top: 0; left: 0; pointer-events: none; z-index: 0; }
    </style>
</head>
<body>

    <div class="bg-overlay"></div>
    <div class="blur-layer"></div>
    <audio id="loveMusic" loop><source src="nhac.mp3" type="audio/mpeg"></audio>
    <canvas id="canvas"></canvas>

    <div id="photo-challenge">
        <div class="instruction-text">B·∫Øt ƒë√∫ng em (anh) ƒëi n√®! üò†üí®</div>
        <img src="nguoi-la-1.jpg" class="photo-item" onclick="wrongAnswer()">
        <img src="nguoi-yeu.jpg" class="photo-item" onclick="rightAnswer()">
        <img src="nguoi-la-2.jpg" class="photo-item" onclick="wrongAnswer()">
        <img src="nguoi-la-3.jpg" class="photo-item" onclick="wrongAnswer()">
    </div>

    <div class="input-container" id="inputBox">
        <h2 style="color: var(--text-color); margin-top:0; font-family: 'Montserrat';">B·∫ÆT D√çNH R·ªíI NH√â! ‚ù§Ô∏è</h2>
        <input type="text" id="userName" placeholder="Nh·∫≠p t√™n ng∆∞·ªùi ·∫•y..." autocomplete="off">
        <button onclick="startLove()">X√ÅC NH·∫¨N Y√äU TH∆Ø∆†NG üåπ</button>
    </div>

    <div id="love-rain"></div>
    <div id="final-message"></div>

<script>
    // 1. X·ª¨ L√ù DI CHUY·ªÇN ·∫¢NH (NHANH ƒê·ªÄU)
    const photos = document.querySelectorAll('.photo-item');
    const photoData = [];
    const BASE_SPEED = 28; 

    photos.forEach(photo => {
        let dx = (Math.random() - 0.5) * BASE_SPEED;
        let dy = (Math.random() - 0.5) * BASE_SPEED;
        if (Math.abs(dx) < 18) dx = dx < 0 ? -18 : 18; // √âp t·ªëc ƒë·ªô t·ªëi thi·ªÉu
        if (Math.abs(dy) < 18) dy = dy < 0 ? -18 : 18;

        photoData.push({
            el: photo,
            x: Math.random() * (window.innerWidth - 115),
            y: Math.random() * (window.innerHeight - 115),
            dx: dx, dy: dy, rotation: 0,
            rotSpeed: (Math.random() - 0.5) * 12
        });
    });

    function updatePhysics() {
        photoData.forEach(p => {
            p.x += p.dx; p.y += p.dy; p.rotation += p.rotSpeed;
            if (p.x + 115 > window.innerWidth || p.x < 0) p.dx *= -1;
            if (p.y + 115 > window.innerHeight || p.y < 0) p.dy *= -1;
            p.el.style.left = p.x + 'px';
            p.el.style.top = p.y + 'px';
            p.el.style.transform = `rotate(${p.rotation}deg)`;
        });
        requestAnimationFrame(updatePhysics);
    }
    updatePhysics();

    function wrongAnswer() { alert("H·ª•t r·ªìi! üò† Th·ª≠ l·∫°i ƒëi n√†o!"); }
    function rightAnswer() {
        document.getElementById('photo-challenge').style.display = 'none';
        document.getElementById('inputBox').style.display = 'block';
    }

    // 2. HI·ªÜU ·ª®NG CH·ªÆ 3D
    function createFloatingText(content) {
        const container = document.getElementById('love-rain');
        const span = document.createElement('span');
        span.className = 'floating-text';
        span.innerText = content;
        span.style.left = Math.random() * 80 + 10 + '%';
        const duration = Math.random() * 3 + 5;
        span.style.animationDuration = duration + 's';
        span.style.fontSize = Math.random() * 15 + 25 + 'px';
        
        const colors = ['#ff4d6d', '#d63384', '#ff758c', '#ff85a1', '#fb6f92'];
        span.style.color = colors[Math.floor(Math.random() * colors.length)];

        container.appendChild(span);
        setTimeout(() => span.remove(), duration * 1000);
    }

    function startLove() {
        const name = document.getElementById('userName').value.trim();
        if (!name) return alert("Ph·∫£i nh·∫≠p t√™n m·ªõi g·ª≠i ƒë∆∞·ª£c t√¨nh y√™u ch·ª©!");
        
        document.getElementById('loveMusic').play().catch(() => {});
        document.getElementById('inputBox').style.display = 'none';
        
        let loveInterval = setInterval(() => {
            const icons = ["‚ù§Ô∏è", "üåπ", "üíñ", "üå∑", "üå∏", "‚ú®"];
            createFloatingText(`LOVE U ${name.toUpperCase()} ${icons[Math.floor(Math.random()*icons.length)]}`);
        }, 250);

        setTimeout(() => {
            clearInterval(loveInterval);
            setTimeout(() => {
                const final = document.getElementById('final-message');
                final.innerText = `M√ÉI Y√äU ${name.toUpperCase()}!\nHAPPY VALENTINE'S DAY! ‚ù§Ô∏è`;
                final.style.transform = 'translate(-50%, -50%) scale(1)';
            }, 3000);
        }, 10000);
    }

    // 3. CANVAS TR√ÅI TIM N·ªÄN (Gi·ªØ nguy√™n cho ƒë·∫πp)
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener('resize', resize); resize();

    function drawHeart(x, y, size, color, opacity) {
        ctx.save(); ctx.beginPath(); ctx.translate(x, y); ctx.scale(size, size);
        ctx.moveTo(0, 0); ctx.bezierCurveTo(-1.5, -1.5, -1.5, 0.5, 0, 1.5);
        ctx.bezierCurveTo(1.5, 0.5, 1.5, -1.5, 0, 0);
        ctx.fillStyle = color; ctx.globalAlpha = opacity; ctx.fill(); ctx.restore();
    }

    class HeartParticle {
        constructor() { this.reset(); }
        reset() { this.x = Math.random() * canvas.width; this.y = canvas.height + 50; this.size = Math.random() * 8 + 3; this.speed = Math.random() * 1 + 0.5; this.opacity = Math.random() * 0.4 + 0.1; this.color = '#ffccd5'; }
        update() { this.y -= this.speed; if (this.y < -50) this.reset(); }
        draw() { drawHeart(this.x, this.y, this.size / 10, this.color, this.opacity); }
    }
    let particles = Array.from({length: 25}, () => new HeartParticle());
    function animate() { ctx.clearRect(0, 0, canvas.width, canvas.height); particles.forEach(p => { p.update(); p.draw(); }); requestAnimationFrame(animate); }
    animate();
</script>
</body>
</html>
